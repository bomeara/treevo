<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="David W. Bapst" />

<meta name="date" content="2018-05-08" />

<title>Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</h1>
<h4 class="author"><em>David W. Bapst</em></h4>
<h4 class="date"><em>2018-05-08</em></h4>



<p>For this vignette, we will use the tree of ammonite genera, and the continuous character data for those ammonites, taken from Raia et al. (2015, American Naturalist). This data is taken from their supplemental appendix, available at the American Naturalist website, and is available as an example dataset in R package <code>paleotree</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(paleotree)</code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(RaiaCopesRule)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()</code></pre></div>
<pre><code>##  [1] &quot;ammoniteTraitsRaia&quot;  &quot;ammoniteTreeRaia&quot;    &quot;ceratopsianTreeRaia&quot;
##  [4] &quot;cervidTreeRaia&quot;      &quot;charData&quot;            &quot;coreLimit&quot;          
##  [7] &quot;generation.time&quot;     &quot;multicore&quot;           &quot;results&quot;            
## [10] &quot;resultsBound&quot;        &quot;shellSize&quot;           &quot;sutureComplexity&quot;   
## [13] &quot;tree&quot;</code></pre>
<p>The trees for the three groups examined in this paper all appear to be trees dated to the last appearance times (as opposed to the first appearance time) <em>and</em> specifically the end-boundary of the interval containing the last appearance.</p>
<p>First, letâ€™s plot the tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">ladderize</span>(ammoniteTreeRaia), <span class="dt">show.tip.label=</span><span class="ot">FALSE</span>)
<span class="kw">axisPhylo</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This tree has polytomies - we will have to deal with that. Letâ€™s randomly resolve tree using <code>multi2di</code> from ape, and then use function <code>addTermBranchLength</code> from package <code>paleotree</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree&lt;-<span class="kw">multi2di</span>(ammoniteTreeRaia)

<span class="co"># let's apply ATBL</span>
tree&lt;-<span class="kw">addTermBranchLength</span>(tree,<span class="fl">0.01</span>)

<span class="co"># let's try plotting it again</span>
<span class="kw">plot</span>(<span class="kw">ladderize</span>(tree), <span class="dt">show.tip.label=</span><span class="ot">FALSE</span>)
<span class="kw">axisPhylo</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Because we arenâ€™t adjust the internal edges at all, <code>multi2di</code> has just inserted a number of zero-length internal edges between internodes within the tree. This means that alternative resolutions of the tree (as multi2di is stochastic) wonâ€™t create meaningfully different variance-covariance matrices, so we likely donâ€™t need to worry about resolving multiple trees in this case (because weâ€™re taking the trees used by Raia et al. at total face-value, which perhaps is the truly unsupported assumption).</p>
<p>Letâ€™s plot a traitgram of the data.</p>
<p>maybe use phytools rather than mine?</p>
<pre><code>## Plotting ancestral reconstructions for nodes.
## Plotting ancestral reconstructions for nodes.</code></pre>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>how small is the smallest branch length, even after extending terminal branches?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brlen&lt;-tree<span class="op">$</span>edge.length
<span class="kw">min</span>(brlen)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># zero-length branches!</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># what about not zero-length branches?</span>
<span class="kw">min</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>])</code></pre></div>
<pre><code>## [1] 0.199982</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># in years</span>
<span class="kw">min</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>])<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></code></pre></div>
<pre><code>## [1] 199982</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># let's look at the distribution of these edge lengths, ignoring zero-length</span>
<span class="kw">hist</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># total number of zero-length branches</span>
<span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 113</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># proportion of edges that are zero-length</span>
<span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span><span class="kw">length</span>(brlen)</code></pre></div>
<pre><code>## [1] 0.2354167</code></pre>
<p>Yeesh - nearly a quarter of branches on this tree are zero-length branches. Not looking so good.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of zero-length internal branches</span>
<span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tree<span class="op">$</span>edge[,<span class="dv">2</span>]<span class="op">&gt;</span><span class="kw">Ntip</span>(tree))</code></pre></div>
<pre><code>## [1] 113</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of zero-length terminal branches </span>
  <span class="co"># (shouldn't be any because of our application of ATBL)</span>
<span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tree<span class="op">$</span>edge[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="kw">Ntip</span>(tree))</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Letâ€™s use TreEvo!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(TreEvo)</code></pre></div>
<pre><code>## 
## Attaching package: 'TreEvo'</code></pre>
<pre><code>## The following objects are masked _by_ '.GlobalEnv':
## 
##     results, resultsBound</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># character data for doRun must be in matrix form</span>
  <span class="co"># with rows labeled with taxon names</span>

charData&lt;-<span class="kw">matrix</span>(sutureComplexity,<span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">rownames</span>(charData)&lt;-<span class="kw">names</span>(sutureComplexity)</code></pre></div>
<p>Letâ€™s analyze it with ordinary BM</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resultsBM&lt;-<span class="kw">doRun_prc</span>(
  <span class="dt">phy =</span> tree,
  <span class="dt">traits =</span> charData,
  <span class="dt">intrinsicFn=</span>brownianIntrinsic,
  <span class="dt">extrinsicFn=</span>nullExtrinsic,
  <span class="dt">startingPriorsFns=</span><span class="st">&quot;normal&quot;</span>,
  <span class="dt">startingPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(charData[,<span class="dv">1</span>]), <span class="kw">sd</span>(charData[,<span class="dv">1</span>]))),
  <span class="dt">intrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">&quot;exponential&quot;</span>),
  <span class="dt">intrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),
  <span class="dt">extrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">&quot;fixed&quot;</span>),
  <span class="dt">extrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),
  <span class="dt">generation.time=</span>generation.time,
  <span class="dt">standardDevFactor=</span><span class="fl">0.2</span>,
  <span class="dt">plot=</span><span class="ot">FALSE</span>,
  <span class="dt">StartSims=</span><span class="dv">10</span>,
  <span class="dt">epsilonProportion=</span><span class="fl">0.7</span>,
  <span class="dt">epsilonMultiplier=</span><span class="fl">0.7</span>,
  <span class="dt">nStepsPRC=</span><span class="dv">3</span>,
  <span class="dt">numParticles=</span><span class="dv">20</span>,
  <span class="dt">jobName=</span><span class="st">&quot;typicalBMrun&quot;</span>,
  <span class="dt">stopRule=</span><span class="ot">FALSE</span>,
  <span class="dt">multicore=</span>multicore,
  <span class="dt">coreLimit=</span>coreLimit,
  <span class="dt">verboseParticles=</span><span class="ot">TRUE</span>
  )</code></pre></div>
<p>Letâ€™s analyze it with ordinary BM with a bound</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resultsBound&lt;-<span class="kw">doRun_prc</span>(
  <span class="dt">phy =</span> tree,
  <span class="dt">traits =</span> charData,
  <span class="dt">intrinsicFn=</span>boundaryMinIntrinsic,
  <span class="dt">extrinsicFn=</span>nullExtrinsic,
  <span class="dt">startingPriorsFns=</span><span class="st">&quot;normal&quot;</span>,
  <span class="dt">startingPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(charData[,<span class="dv">1</span>]), <span class="kw">sd</span>(charData[,<span class="dv">1</span>]))),
  <span class="dt">intrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;normal&quot;</span>),
  <span class="dt">intrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="op">-</span><span class="dv">10</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),
  <span class="dt">extrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">&quot;fixed&quot;</span>),
  <span class="dt">extrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),
  <span class="dt">generation.time=</span>generation.time,
  <span class="dt">standardDevFactor=</span><span class="fl">0.2</span>,
  <span class="dt">plot=</span><span class="ot">FALSE</span>,
  <span class="dt">StartSims=</span><span class="dv">10</span>,
  <span class="dt">epsilonProportion=</span><span class="fl">0.7</span>,
  <span class="dt">epsilonMultiplier=</span><span class="fl">0.7</span>,
  <span class="dt">nStepsPRC=</span><span class="dv">3</span>,
  <span class="dt">numParticles=</span><span class="dv">20</span>,
  <span class="dt">jobName=</span><span class="st">&quot;BMwithBoundRun&quot;</span>,
  <span class="dt">stopRule=</span><span class="ot">FALSE</span>,
  <span class="dt">multicore=</span>multicore,
  <span class="dt">coreLimit=</span>coreLimit,
  <span class="dt">verboseParticles=</span><span class="ot">FALSE</span>
  )</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resultsBM&lt;-results</code></pre></div>
<p>The function <code>highestPostDens</code> provides us with the weighted mean, standard deviation, upper and lower highest posterior density (HPD) for each free parameter in the posterior sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">highestPostDens</span>(resultsBM<span class="op">$</span>particleDataFrame, <span class="dt">percent=</span><span class="fl">0.95</span>, <span class="dt">returnData=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>##                   mean         sd LowerHPD_0.95 UpperHPD_0.95
## starting_1  1.29906267 0.15299374  1.0516170253    1.53611647
## intrinsic_1 0.02931131 0.01646499  0.0006309567    0.05482759</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">highestPostDens</span>(resultsBound<span class="op">$</span>particleDataFrame, <span class="dt">percent=</span><span class="fl">0.95</span>, <span class="dt">returnData=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>##                     mean         sd LowerHPD_0.95 UpperHPD_0.95
## starting_1    1.31193672 0.16965641   1.038005752    1.57120277
## intrinsic_1   0.04425074 0.02813518   0.007019404    0.09468806
## intrinsic_2 -10.00452457 0.71787067 -11.227135061   -9.00084253</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This function calculates Effective Sample Size (ESS) on results.  </span>
<span class="co"># Performs the best when results are from multiple runs.</span>

<span class="co"># ESS for single runs</span>
<span class="kw">pairwiseESS</span>(resultsBM<span class="op">$</span>particleDataFrame)</code></pre></div>
<pre><code>## Warning in pairwiseESS(resultsBM$particleDataFrame): ESS on a single run
## should be high; consider combining several runs</code></pre>
<pre><code>##             ESS
## starting_1   30
## intrinsic_1  30
## &lt;NA&gt;          0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairwiseESS</span>(resultsBound<span class="op">$</span>particleDataFrame)</code></pre></div>
<pre><code>## Warning in pairwiseESS(resultsBound$particleDataFrame): ESS on a single run
## should be high; consider combining several runs</code></pre>
<pre><code>##                   ESS
## starting_1  36.000000
## intrinsic_1 36.000000
## intrinsic_2  6.991013
## &lt;NA&gt;         0.000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ESS for parameters shared between BM and bound</span>
<span class="co">#pairwiseESS(list(resultsBM$particleDataFrame,resultsBound$particleDataFrame))</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plotPosteriors</span>
    <span class="co"># for each free parameter in the posterior, a plot is made of the distribution of values estimate in the last generation</span>

<span class="kw">plotPosteriors</span>(<span class="dt">particleDataFrame=</span>resultsBM<span class="op">$</span>particleDataFrame,
   <span class="dt">priorsMat=</span>resultsBM<span class="op">$</span>PriorMatrix)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotPosteriors</span>(<span class="dt">particleDataFrame=</span>resultsBound<span class="op">$</span>particleDataFrame,
   <span class="dt">priorsMat=</span>resultsBound<span class="op">$</span>PriorMatrix)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
