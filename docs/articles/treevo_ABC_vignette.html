<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo • TreEvo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo">
<meta property="og:description" content="TreEvo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bomeara/TreEvo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="treevo_ABC_vignette_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</h1>
                        <h4 class="author">David W. Bapst</h4>
            
            <h4 class="date">2021-07-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bomeara/TreEvo/blob/master/vignettes/treevo_ABC_vignette.Rmd"><code>vignettes/treevo_ABC_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>treevo_ABC_vignette.Rmd</code></div>

    </div>

    
    
<p>For this vignette, we will use the tree of ammonite genera, and the continuous character data for those ammonites, taken from Raia et al. (2015, American Naturalist). This data is taken from their supplemental appendix, available at the American Naturalist website, and is available as an example dataset in R package <code>paleotree</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dwbapst/paleotree">paleotree</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">RaiaCopesRule</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "ammoniteTraitsRaia"   "ammoniteTreeRaia"     "ceratopsianTreeRaia" 
##  [4] "cervidTreeRaia"       "charData"             "coreLimit"           
##  [7] "generation.time"      "multicore"            "nInitialSimsPerParam"
## [10] "nRuns"                "nStepsPRC"            "numParticles"        
## [13] "resultsBM"            "resultsBound"         "shellSize"           
## [16] "sutureComplexity"     "tree"</code></pre>
<p>The trees for the three groups examined in this paper all appear to be trees dated to the last appearance times (as opposed to the first appearance time) <em>and</em> specifically the end-boundary of the interval containing the last appearance.</p>
<p>First, let’s plot the tree:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">ladderize</span><span class="op">(</span><span class="va">ammoniteTreeRaia</span><span class="op">)</span>, show.tip.label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">axisPhylo</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>This tree has polytomies - we will have to deal with that. Let’s randomly resolve tree using <code>multi2di</code> from ape, and then use function <code>addTermBranchLength</code> from package <code>paleotree</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree</span><span class="op">&lt;-</span><span class="fu">multi2di</span><span class="op">(</span><span class="va">ammoniteTreeRaia</span><span class="op">)</span>

<span class="co"># let's apply ATBL</span>
<span class="va">tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/paleotree/man/modifyTerminalBranches.html">addTermBranchLength</a></span><span class="op">(</span><span class="va">tree</span>,<span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in tree$edge.length[newBrLen] &lt;- newBrLen: number of items to replace is
## not a multiple of replacement length</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's try plotting it again</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">ladderize</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span>, show.tip.label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">axisPhylo</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Because we aren’t adjust the internal edges at all, <code>multi2di</code> has just inserted a number of zero-length internal edges between internodes within the tree. This means that alternative resolutions of the tree (as multi2di is stochastic) won’t create meaningfully different variance-covariance matrices, so we likely don’t need to worry about resolving multiple trees in this case (because we’re taking the trees used by Raia et al. at total face-value, which perhaps is the truly unsupported assumption).</p>
<p>Let’s plot a traitgram of the data.</p>
<p>maybe use phytools rather than mine?</p>
<pre><code>## Plotting ancestral reconstructions for nodes.
## Plotting ancestral reconstructions for nodes.</code></pre>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>how small is the smallest branch length, even after extending terminal branches?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brlen</span><span class="op">&lt;-</span><span class="va">tree</span><span class="op">$</span><span class="va">edge.length</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># zero-length branches!</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># what about not zero-length branches?</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">[</span><span class="va">brlen</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.199982</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># in years</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">[</span><span class="va">brlen</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span></code></pre></div>
<pre><code>## [1] 199982</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's look at the distribution of these edge lengths, ignoring zero-length</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">[</span><span class="va">brlen</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>, main<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">"edge length"</span><span class="op">)</span></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># total number of zero-length branches</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># proportion of edges that are zero-length</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.2041667</code></pre>
<p>Yeesh - nearly a quarter of branches on this tree are zero-length branches. Not looking so good.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># number of zero-length internal branches</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">tree</span><span class="op">$</span><span class="va">edge</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&gt;</span><span class="fu">Ntip</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># number of zero-length terminal branches </span>
  <span class="co"># (shouldn't be any because of our application of ATBL)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">brlen</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">tree</span><span class="op">$</span><span class="va">edge</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;=</span><span class="fu">Ntip</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Let’s use TreEvo!</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bomeara/treevo">TreEvo</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: replacing previous import 'phytools::scores' by 'pls::scores' when
## loading 'TreEvo'</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"TreEvo"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] '0.22.0'</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># character data for doRun must be in matrix form</span>
  <span class="co"># with rows labeled with taxon names</span>

<span class="va">charData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">sutureComplexity</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">charData</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sutureComplexity</span><span class="op">)</span></code></pre></div>
<p>Let’s analyze it with ordinary BM</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resultsBM</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/doRun.html">doRun_prc</a></span><span class="op">(</span>
  phy <span class="op">=</span> <span class="va">tree</span>,
  traits <span class="op">=</span> <span class="va">charData</span>,
  intrinsicFn<span class="op">=</span><span class="va">brownianIntrinsic</span>,
  extrinsicFn<span class="op">=</span><span class="va">nullExtrinsic</span>,
  startingPriorsFns<span class="op">=</span><span class="st">"normal"</span>,
  startingPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">charData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">charData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  intrinsicPriorsFns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"exponential"</span><span class="op">)</span>,
  intrinsicPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,
  extrinsicPriorsFns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fixed"</span><span class="op">)</span>,
  extrinsicPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,
  generation.time<span class="op">=</span><span class="va">generation.time</span>,
  standardDevFactor<span class="op">=</span><span class="fl">0.2</span>,
  plot<span class="op">=</span><span class="cn">FALSE</span>,
  StartSims<span class="op">=</span><span class="fl">10</span>,
  epsilonProportion<span class="op">=</span><span class="fl">0.7</span>,
  epsilonMultiplier<span class="op">=</span><span class="fl">0.7</span>,
  nStepsPRC<span class="op">=</span><span class="fl">3</span>,
  numParticles<span class="op">=</span><span class="fl">20</span>,
  jobName<span class="op">=</span><span class="st">"typicalBMrun"</span>,
  stopRule<span class="op">=</span><span class="cn">FALSE</span>,
  multicore<span class="op">=</span><span class="va">multicore</span>,
  coreLimit<span class="op">=</span><span class="va">coreLimit</span>,
  verboseParticles<span class="op">=</span><span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
<p>Let’s analyze it with ordinary BM with a bound</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">resultsBound</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/doRun.html">doRun_prc</a></span><span class="op">(</span>
  phy <span class="op">=</span> <span class="va">tree</span>,
  traits <span class="op">=</span> <span class="va">charData</span>,
  intrinsicFn<span class="op">=</span><span class="va">boundaryMinIntrinsic</span>,
  extrinsicFn<span class="op">=</span><span class="va">nullExtrinsic</span>,
  startingPriorsFns<span class="op">=</span><span class="st">"normal"</span>,
  startingPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">charData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">charData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  intrinsicPriorsFns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"exponential"</span>,<span class="st">"normal"</span><span class="op">)</span>,
  intrinsicPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,
  extrinsicPriorsFns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fixed"</span><span class="op">)</span>,
  extrinsicPriorsValues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,
  generation.time<span class="op">=</span><span class="va">generation.time</span>,
  standardDevFactor<span class="op">=</span><span class="fl">0.2</span>,
  plot<span class="op">=</span><span class="cn">FALSE</span>,
  StartSims<span class="op">=</span><span class="fl">10</span>,
  epsilonProportion<span class="op">=</span><span class="fl">0.7</span>,
  epsilonMultiplier<span class="op">=</span><span class="fl">0.7</span>,
  nStepsPRC<span class="op">=</span><span class="fl">3</span>,
  numParticles<span class="op">=</span><span class="fl">20</span>,
  jobName<span class="op">=</span><span class="st">"BMwithBoundRun"</span>,
  stopRule<span class="op">=</span><span class="cn">FALSE</span>,
  multicore<span class="op">=</span><span class="va">multicore</span>,
  coreLimit<span class="op">=</span><span class="va">coreLimit</span>,
  verboseParticles<span class="op">=</span><span class="cn">FALSE</span>
  <span class="op">)</span></code></pre></div>
<p>The function <code>summarizePosterior</code> provides us with the mean, standard deviation, and highest posterior density (HPD) for each free parameter in the posterior sample, for each individual run. We can specify the probability density we would like to receive the bounds for using the <code>alpha</code> argument.</p>
<p>For example, for each Brownian Motion run:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span><span class="op">(</span><span class="va">resultsBM</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">particleDataFrame</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span><span class="op">(</span><span class="va">resultsBM</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">particleDataFrame</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span><span class="op">(</span><span class="va">resultsBM</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">particleDataFrame</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p>Or just to look at the first run of the Bounded BM run:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span><span class="op">(</span><span class="va">resultsBound</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">particleDataFrame</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This function calculates Effective Sample Size (ESS) on results.  </span>
<span class="co"># Performs the best when results are from multiple runs.</span>

<span class="co"># ESS for single runs</span>
<span class="fu"><a href="../reference/pairwiseESS.html">pairwiseESS</a></span><span class="op">(</span><span class="va">resultsBM</span><span class="op">)</span>

<span class="fu"><a href="../reference/pairwiseESS.html">pairwiseESS</a></span><span class="op">(</span><span class="va">resultsBound</span><span class="op">)</span>

<span class="co"># ESS for parameters shared between BM and bound</span>
<span class="co">#pairwiseESS(list(resultsBM$particleDataFrame,resultsBound$particleDataFrame))</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plotPosteriors</span>
    <span class="co"># for each free parameter in the posterior, a plot is made of the distribution of values estimate in the last generation</span>

<span class="co"># collect the particleDataFrames into lists</span>

<span class="va">resultsBMpart</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">resultsBM</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">particleDataFrame</span><span class="op">)</span>

<span class="va">resultsBoundpart</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">resultsBound</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">particleDataFrame</span><span class="op">)</span>

<span class="fu"><a href="../reference/plotPosteriors.html">plotPosteriors</a></span><span class="op">(</span>particleDataFrame<span class="op">=</span><span class="va">resultsBMpart</span>,
   priorsMat<span class="op">=</span><span class="va">resultsBM</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">PriorMatrix</span><span class="op">)</span>

<span class="fu"><a href="../reference/plotPosteriors.html">plotPosteriors</a></span><span class="op">(</span>particleDataFrame<span class="op">=</span><span class="va">resultsBoundpart</span>,
   priorsMat<span class="op">=</span><span class="va">resultsBound</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">PriorMatrix</span><span class="op">)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Brian O'Meara, David Bapst, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
