<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo • TreEvo</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bomeara/treevo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</h1>
                        <h4 class="author">David W. Bapst</h4>
            
            <h4 class="date">2018-09-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bomeara/treevo/blob/master/vignettes/treevo_ABC_vignette.Rmd"><code>vignettes/treevo_ABC_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>treevo_ABC_vignette.Rmd</code></div>

    </div>

    
    
<p>For this vignette, we will use the tree of ammonite genera, and the continuous character data for those ammonites, taken from Raia et al. (2015, American Naturalist). This data is taken from their supplemental appendix, available at the American Naturalist website, and is available as an example dataset in R package <code>paleotree</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(paleotree)</a></code></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data</span>(RaiaCopesRule)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">ls</span>()</a></code></pre></div>
<pre><code>##  [1] "ammoniteTraitsRaia"   "ammoniteTreeRaia"     "ceratopsianTreeRaia" 
##  [4] "cervidTreeRaia"       "charData"             "coreLimit"           
##  [7] "generation.time"      "multicore"            "nInitialSimsPerParam"
## [10] "nRuns"                "nStepsPRC"            "numParticles"        
## [13] "resultsBM"            "resultsBound"         "shellSize"           
## [16] "sutureComplexity"     "tree"</code></pre>
<p>The trees for the three groups examined in this paper all appear to be trees dated to the last appearance times (as opposed to the first appearance time) <em>and</em> specifically the end-boundary of the interval containing the last appearance.</p>
<p>First, let’s plot the tree:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">ladderize</span>(ammoniteTreeRaia), <span class="dt">show.tip.label=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">axisPhylo</span>()</a></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>This tree has polytomies - we will have to deal with that. Let’s randomly resolve tree using <code>multi2di</code> from ape, and then use function <code>addTermBranchLength</code> from package <code>paleotree</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">tree&lt;-<span class="kw">multi2di</span>(ammoniteTreeRaia)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># let's apply ATBL</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">tree&lt;-<span class="kw"><a href="http://www.rdocumentation.org/packages/paleotree/topics/modifyTerminalBranches">addTermBranchLength</a></span>(tree,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># let's try plotting it again</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">plot</span>(<span class="kw">ladderize</span>(tree), <span class="dt">show.tip.label=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">axisPhylo</span>()</a></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Because we aren’t adjust the internal edges at all, <code>multi2di</code> has just inserted a number of zero-length internal edges between internodes within the tree. This means that alternative resolutions of the tree (as multi2di is stochastic) won’t create meaningfully different variance-covariance matrices, so we likely don’t need to worry about resolving multiple trees in this case (because we’re taking the trees used by Raia et al. at total face-value, which perhaps is the truly unsupported assumption).</p>
<p>Let’s plot a traitgram of the data.</p>
<p>maybe use phytools rather than mine?</p>
<pre><code>## Plotting ancestral reconstructions for nodes.
## Plotting ancestral reconstructions for nodes.</code></pre>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>how small is the smallest branch length, even after extending terminal branches?</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">brlen&lt;-tree<span class="op">$</span>edge.length</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">min</span>(brlen)</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># zero-length branches!</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># what about not zero-length branches?</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">min</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>])</a></code></pre></div>
<pre><code>## [1] 0.199982</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># in years</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">min</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>])<span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></a></code></pre></div>
<pre><code>## [1] 199982</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># let's look at the distribution of these edge lengths, ignoring zero-length</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">hist</span>(brlen[brlen<span class="op">!=</span><span class="dv">0</span>], <span class="dt">main=</span><span class="st">""</span>,<span class="dt">xlab=</span><span class="st">"edge length"</span>)</a></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># total number of zero-length branches</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 113</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># proportion of edges that are zero-length</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span><span class="kw">length</span>(brlen)</a></code></pre></div>
<pre><code>## [1] 0.2354167</code></pre>
<p>Yeesh - nearly a quarter of branches on this tree are zero-length branches. Not looking so good.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># number of zero-length internal branches</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tree<span class="op">$</span>edge[,<span class="dv">2</span>]<span class="op">&gt;</span><span class="kw">Ntip</span>(tree))</a></code></pre></div>
<pre><code>## [1] 113</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># number of zero-length terminal branches </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  <span class="co"># (shouldn't be any because of our application of ATBL)</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">sum</span>(brlen<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>tree<span class="op">$</span>edge[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="kw">Ntip</span>(tree))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Let’s use TreEvo!</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">library</span>(TreEvo)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'TreEvo'</code></pre>
<pre><code>## The following object is masked _by_ '.GlobalEnv':
## 
##     resultsBound</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># character data for doRun must be in matrix form</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  <span class="co"># with rows labeled with taxon names</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">charData&lt;-<span class="kw">matrix</span>(sutureComplexity,<span class="dt">ncol=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="kw">rownames</span>(charData)&lt;-<span class="kw">names</span>(sutureComplexity)</a></code></pre></div>
<p>Let’s analyze it with ordinary BM</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">resultsBM&lt;-<span class="kw"><a href="../reference/doRun.html">doRun_prc</a></span>(</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  <span class="dt">phy =</span> tree,</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  <span class="dt">traits =</span> charData,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">  <span class="dt">intrinsicFn=</span>brownianIntrinsic,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="dt">extrinsicFn=</span>nullExtrinsic,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="dt">startingPriorsFns=</span><span class="st">"normal"</span>,</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  <span class="dt">startingPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(charData[,<span class="dv">1</span>]), <span class="kw">sd</span>(charData[,<span class="dv">1</span>]))),</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  <span class="dt">intrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">"exponential"</span>),</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">  <span class="dt">intrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  <span class="dt">extrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">"fixed"</span>),</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">  <span class="dt">extrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">  <span class="dt">generation.time=</span>generation.time,</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">  <span class="dt">standardDevFactor=</span><span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb29-14" data-line-number="14">  <span class="dt">plot=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb29-15" data-line-number="15">  <span class="dt">StartSims=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb29-16" data-line-number="16">  <span class="dt">epsilonProportion=</span><span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb29-17" data-line-number="17">  <span class="dt">epsilonMultiplier=</span><span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb29-18" data-line-number="18">  <span class="dt">nStepsPRC=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb29-19" data-line-number="19">  <span class="dt">numParticles=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb29-20" data-line-number="20">  <span class="dt">jobName=</span><span class="st">"typicalBMrun"</span>,</a>
<a class="sourceLine" id="cb29-21" data-line-number="21">  <span class="dt">stopRule=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb29-22" data-line-number="22">  <span class="dt">multicore=</span>multicore,</a>
<a class="sourceLine" id="cb29-23" data-line-number="23">  <span class="dt">coreLimit=</span>coreLimit,</a>
<a class="sourceLine" id="cb29-24" data-line-number="24">  <span class="dt">verboseParticles=</span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb29-25" data-line-number="25">  )</a></code></pre></div>
<p>Let’s analyze it with ordinary BM with a bound</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">resultsBound&lt;-<span class="kw"><a href="../reference/doRun.html">doRun_prc</a></span>(</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">  <span class="dt">phy =</span> tree,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">  <span class="dt">traits =</span> charData,</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">  <span class="dt">intrinsicFn=</span>boundaryMinIntrinsic,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="dt">extrinsicFn=</span>nullExtrinsic,</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="dt">startingPriorsFns=</span><span class="st">"normal"</span>,</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">  <span class="dt">startingPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(charData[,<span class="dv">1</span>]), <span class="kw">sd</span>(charData[,<span class="dv">1</span>]))),</a>
<a class="sourceLine" id="cb30-8" data-line-number="8">  <span class="dt">intrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">"exponential"</span>,<span class="st">"normal"</span>),</a>
<a class="sourceLine" id="cb30-9" data-line-number="9">  <span class="dt">intrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">-10</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb30-10" data-line-number="10">  <span class="dt">extrinsicPriorsFns=</span><span class="kw">c</span>(<span class="st">"fixed"</span>),</a>
<a class="sourceLine" id="cb30-11" data-line-number="11">  <span class="dt">extrinsicPriorsValues=</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb30-12" data-line-number="12">  <span class="dt">generation.time=</span>generation.time,</a>
<a class="sourceLine" id="cb30-13" data-line-number="13">  <span class="dt">standardDevFactor=</span><span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb30-14" data-line-number="14">  <span class="dt">plot=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb30-15" data-line-number="15">  <span class="dt">StartSims=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb30-16" data-line-number="16">  <span class="dt">epsilonProportion=</span><span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb30-17" data-line-number="17">  <span class="dt">epsilonMultiplier=</span><span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb30-18" data-line-number="18">  <span class="dt">nStepsPRC=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb30-19" data-line-number="19">  <span class="dt">numParticles=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb30-20" data-line-number="20">  <span class="dt">jobName=</span><span class="st">"BMwithBoundRun"</span>,</a>
<a class="sourceLine" id="cb30-21" data-line-number="21">  <span class="dt">stopRule=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb30-22" data-line-number="22">  <span class="dt">multicore=</span>multicore,</a>
<a class="sourceLine" id="cb30-23" data-line-number="23">  <span class="dt">coreLimit=</span>coreLimit,</a>
<a class="sourceLine" id="cb30-24" data-line-number="24">  <span class="dt">verboseParticles=</span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25">  )</a></code></pre></div>
<p>The function <code>summarizePosterior</code> provides us with the mean, standard deviation, and highest posterior density (HPD) for each free parameter in the posterior sample, for each individual run. We can specify the probability density we would like to receive the bounds for using the <code>alpha</code> argument.</p>
<p>For example, for each Brownian Motion run:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span>(resultsBM[[<span class="dv">1</span>]]<span class="op">$</span>particleDataFrame, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<pre><code>## $starting_1
## $starting_1$mean
## [1] 1.338346
## 
## $starting_1$sd
## [1] 0.1379334
## 
## $starting_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]              1.17999              1.520336
## 
## 
## $intrinsic_1
## $intrinsic_1$mean
## [1] 0.03216874
## 
## $intrinsic_1$sd
## [1] 0.01882001
## 
## $intrinsic_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]          0.004458576            0.05605334</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span>(resultsBM[[<span class="dv">2</span>]]<span class="op">$</span>particleDataFrame, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<pre><code>## $starting_1
## $starting_1$mean
## [1] 1.309353
## 
## $starting_1$sd
## [1] 0.140024
## 
## $starting_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]              1.08707              1.457697
## 
## 
## $intrinsic_1
## $intrinsic_1$mean
## [1] 0.004698786
## 
## $intrinsic_1$sd
## [1] 0.002421889
## 
## $intrinsic_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]          0.001300522            0.00813148</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span>(resultsBM[[<span class="dv">3</span>]]<span class="op">$</span>particleDataFrame, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<pre><code>## $starting_1
## $starting_1$mean
## [1] 1.30034
## 
## $starting_1$sd
## [1] 0.1390082
## 
## $starting_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]             1.118637              1.500256
## 
## 
## $intrinsic_1
## $intrinsic_1$mean
## [1] 0.04580618
## 
## $intrinsic_1$sd
## [1] 0.02540993
## 
## $intrinsic_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]          0.008022971            0.07925108</code></pre>
<p>Or just to look at the first run of the Bounded BM run:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="../reference/summarizePosterior.html">summarizePosterior</a></span>(resultsBound[[<span class="dv">1</span>]]<span class="op">$</span>particleDataFrame, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<pre><code>## $starting_1
## $starting_1$mean
## [1] 1.236393
## 
## $starting_1$sd
## [1] 0.1565172
## 
## $starting_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]             1.098027              1.461625
## 
## 
## $intrinsic_1
## $intrinsic_1$mean
## [1] 0.003819127
## 
## $intrinsic_1$sd
## [1] 0.001981337
## 
## $intrinsic_1$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]          0.001135231           0.006654571
## 
## 
## $intrinsic_2
## $intrinsic_2$mean
## [1] -9.820411
## 
## $intrinsic_2$sd
## [1] 0.8847374
## 
## $intrinsic_2$HPD
##      LowerBound_alpha=0.8 UpperBound__alpha=0.8
## [1,]            -11.10327             -8.734233</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># This function calculates Effective Sample Size (ESS) on results.  </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="co"># Performs the best when results are from multiple runs.</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co"># ESS for single runs</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="kw"><a href="../reference/pairwiseESS.html">pairwiseESS</a></span>(resultsBM)</a></code></pre></div>
<pre><code>## Multiple runs of doRun_prc found, extracting particleDataFrame objects</code></pre>
<pre><code>##                    1.2      1.3        2.3     1.2.3
## starting_1  270.000000 278.6239 288.000000 439.00000
## intrinsic_1   2.556685 320.0000   5.695156  12.45637</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw"><a href="../reference/pairwiseESS.html">pairwiseESS</a></span>(resultsBound)</a></code></pre></div>
<pre><code>## Multiple runs of doRun_prc found, extracting particleDataFrame objects</code></pre>
<pre><code>##                    1.2      1.3       2.3      1.2.3
## starting_1  259.000000 212.0000 249.00000 360.000000
## intrinsic_1   7.202053 259.6097  14.93587   8.891902
## intrinsic_2 259.000000 212.0000 249.00000 360.000000</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># ESS for parameters shared between BM and bound</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="co">#pairwiseESS(list(resultsBM$particleDataFrame,resultsBound$particleDataFrame))</span></a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># plotPosteriors</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">    <span class="co"># for each free parameter in the posterior, a plot is made of the distribution of values estimate in the last generation</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="co"># collect the particleDataFrames into lists</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">resultsBMpart&lt;-<span class="kw">lapply</span>(resultsBM,<span class="cf">function</span>(x) x<span class="op">$</span>particleDataFrame)</a>
<a class="sourceLine" id="cb46-7" data-line-number="7"></a>
<a class="sourceLine" id="cb46-8" data-line-number="8">resultsBoundpart&lt;-<span class="kw">lapply</span>(resultsBound,<span class="cf">function</span>(x) x<span class="op">$</span>particleDataFrame)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9"></a>
<a class="sourceLine" id="cb46-10" data-line-number="10"><span class="kw"><a href="../reference/plotPosteriors.html">plotPosteriors</a></span>(<span class="dt">particleDataFrame=</span>resultsBMpart,</a>
<a class="sourceLine" id="cb46-11" data-line-number="11">   <span class="dt">priorsMat=</span>resultsBM[[<span class="dv">1</span>]]<span class="op">$</span>PriorMatrix)</a></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw"><a href="../reference/plotPosteriors.html">plotPosteriors</a></span>(<span class="dt">particleDataFrame=</span>resultsBoundpart,</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">   <span class="dt">priorsMat=</span>resultsBound[[<span class="dv">1</span>]]<span class="op">$</span>PriorMatrix)</a></code></pre></div>
<p><img src="treevo_ABC_vignette_files/figure-html/unnamed-chunk-18-2.png" width="672"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Brian O'Meara, Barb Banbury, David Bapst.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
