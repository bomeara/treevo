<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Test If an Outlier Is Within a Highest Density Region of a Multivariate Cloud of Data Points — testMultivarOutlierHDR • TreEvo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Test If an Outlier Is Within a Highest Density Region of a Multivariate Cloud of Data Points — testMultivarOutlierHDR" />
<meta property="og:description" content="This function takes a matrix, consisting of multiple observations
for a set of variables, with observations assumed to be independent
and identically distributed, calculates a highest density interval
for each of those variables (using
highestDensityInterval), and then tests if some
potential 'outlier' (a particular observation for that set of
variables), is within that highest density interval.
Typically, users may want to account for possible non-independence
of the variables, which could lead to inflated false-positive rates
with this test of coverage. To account for this, this function
allows for the option of applying principal component analysis to
rotate the variables, and then calculate the highest density
intervals from the orthogonal principal component scores." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/TreEvo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test If an Outlier Is Within a Highest Density Region of a Multivariate Cloud of Data Points</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/TreEvo/blob/master/R/testMultivarOutlierHDR.R'><code>R/testMultivarOutlierHDR.R</code></a></small>
    <div class="hidden name"><code>testMultivarOutlierHDR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a matrix, consisting of multiple observations
for a set of variables, with observations assumed to be independent
and identically distributed, calculates a highest density interval
for each of those variables (using
<code><a href='highestDensityInterval.html'>highestDensityInterval</a></code>), and then tests if some
potential 'outlier' (a particular observation for that set of
variables), is within that highest density interval.
Typically, users may want to account for possible non-independence
of the variables, which could lead to inflated false-positive rates
with this test of coverage. To account for this, this function
allows for the option of applying principal component analysis to
rotate the variables, and then calculate the highest density
intervals from the orthogonal principal component scores.</p>
    </div>

    <pre class="usage"><span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>
  <span class='va'>dataMatrix</span>,
  <span class='va'>outlier</span>,
  <span class='va'>alpha</span>,
  coda <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verboseMultimodal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  pca <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataMatrix</th>
      <td><p>A matrix consisting of rows of data observations, 
with one or more variables as the columns, such that each multivariate
observation can be reasonably assumed to represent independent, 
identically-distributed random variables. For example, a matrix of
sampled parameter estimates from the post-burnin posterior of a Bayesian MCMC.</p></td>
    </tr>
    <tr>
      <th>outlier</th>
      <td><p>A vector of consisting of a single observation of
one or more variables, with the same length as the number
of columns in /codedataMatrix. Not necessarily
a true 'outlier' <em>per se</em> but
some data point of interest that you wish to test whether it is
inside some given probability density estimated from a sample of points.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The threshold used for defining the highest density frequency
cut-off. If the highest density interval is applied to a Bayesian MCMC
posterior sample, then the interval is effectively calculated for this
value as a posterior probability density.</p></td>
    </tr>
    <tr>
      <th>coda</th>
      <td><p>Default is <code>FALSE</code>. If <code>TRUE</code>, unimodal highest density regions will
instead be calculated using <code>HPDinterval</code> from package <code>coda</code>, which is
similar to the function <code>quantile</code> in that it calculates only a single interval.</p></td>
    </tr>
    <tr>
      <th>verboseMultimodal</th>
      <td><p>If <code>TRUE</code>, the function will print a message
indicating when the inferred highest density interval is discontinuous, and
thus likely reflects that the supplied data is multimodal.</p></td>
    </tr>
    <tr>
      <th>pca</th>
      <td><p>If <code>TRUE</code> (the default), a principal components analysis is
applied to the provided input data, to reorient the data along orthogonal axes, 
with the purpose of potentially reducing covariation among the variables. If
your variables are known to have little covariation among them, and/or have
strange distributions that may violate the multivariate normal assumptions
of a principal components analysis, then it may be advisable to set pca = FALSE.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code>. 
A user may want to mess with this to adjust bandwidth, et cetera.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A logical, indicating whether the given data point (<code>outlier</code>)
is within the multivariate data cloud at the specified threshold
probability density.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Quantiles, or highest density intervals are
essentially a univariate concept. They are calculated
independently on each variable, as if each variable was
independent. They are often used to try to piece together 
'regions' of confidence or credibility in statistics.
Unfortunately, this means that that if variables are correlated, 
the box-like region they describe in the multivariate space
may not cover enough of the actual data scatter, while covering
lots of empty space.</p>
<p>There are several solutions. There are a number of approaches
for fitting ellipsoids to bivariate data. But what about
multivariate datasets, such as sets of parameter estimates from
the posterior of a Bayesian analysis, which may have an
arbitrary number of variables (and thus dimensions)?</p>
<p>A different solution, applied here when <code>pca = TRUE</code>, 
is to remove the non-independence among variables
by rotating the dataset with principal components analysis.
While this approach has its own flaws, such as assuming that the data
reflects a multivariate normal. However, this is absolutely an
improvement on not-rotating, particularly if being
done for the purpose of this functon, which is essentially to measure
coverage--to measure whether some particular set of values falls within a highest
density region (a multivariate highest density interval).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>This function is essentially a wrapper for applying <code>highestDensityInterval</code> to
multivariate data, along with <code><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></code> in package <code>stats</code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David W. Bapst</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># First, you should understand the problems</span>
<span class='co'># with dealing with correlated variables and looking at quantiles</span>

<span class='co'># simulate two correlated variables</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>444</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>*</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>

<span class='co'># find the highest density intervals for each variable</span>
<span class='va'>pIntX</span> <span class='op'>&lt;-</span> <span class='fu'><a href='highestDensityInterval.html'>highestDensityInterval</a></span><span class='op'>(</span><span class='va'>x</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
<span class='va'>pIntY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='highestDensityInterval.html'>highestDensityInterval</a></span><span class='op'>(</span><span class='va'>y</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>

<span class='co'># These define a box-like region that poorly</span>
<span class='co'># describes the actual distribution of</span>
<span class='co'># the data in multivariate space.</span>

<span class='co'># Let's see this ourselves...</span>
<span class='va'>xLims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>pIntX</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>pIntX</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yLims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>pIntY</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>pIntY</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, xlim <span class='op'>=</span> <span class='va'>xLims</span>, ylim <span class='op'>=</span> <span class='va'>yLims</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/rect.html'>rect</a></span><span class='op'>(</span><span class='va'>pIntX</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntY</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntX</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>pIntY</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='input'>
<span class='co'># So, that doesn't look good.</span>
<span class='co'># Let's imagine we wanted to test if some outlier</span>
<span class='co'># was within that box:</span>

<span class='va'>outlier</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>outlier</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='va'>outlier</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='testMultivarOutlierHDR-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># we can use testMultivarOutlierHDR with pca = FALSE</span>
<span class='co'># to do all of the above without visually checking</span>
<span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>, 
    outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, pca <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>    
<span class='co'># Should that really be considered to be within</span>
<span class='co'># the 80% density region of this data cloud?</span>

<span class='co'>#####</span>

<span class='co'># let's try it with PCA</span>

<span class='va'>pcaRes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>PC</span> <span class='op'>&lt;-</span> <span class='va'>pcaRes</span><span class='op'>$</span><span class='va'>scores</span>

<span class='va'>pIntPC1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='highestDensityInterval.html'>highestDensityInterval</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
<span class='va'>pIntPC2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='highestDensityInterval.html'>highestDensityInterval</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>

<span class='co'># plot it</span>
<span class='va'>xLims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntPC1</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntPC1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>yLims</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, <span class='va'>pIntPC2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, <span class='va'>pIntPC2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>PC</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, xlim <span class='op'>=</span> <span class='va'>xLims</span>, ylim <span class='op'>=</span> <span class='va'>yLims</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/rect.html'>rect</a></span><span class='op'>(</span><span class='va'>pIntPC1</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntPC2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>pIntPC1</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>pIntPC2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='testMultivarOutlierHDR-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># That looks a lot better, isnt' filled with lots of</span>
<span class='co'># white space not supported by the observed data.</span>

<span class='co'># And now let's apply testMultivarOutlierHDR, with pca = TRUE</span>
<span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>, 
    outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, pca <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'>#####################</span>

<span class='co'># Example with four complex variables</span>
    <span class='co'># including correlated and multimodal variables</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>*</span><span class='fl'>0.8</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span>, 
  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>30</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span>, 
  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>10</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span>

<span class='co'>#plot(x, y)</span>
<span class='co'>#plot(x, z)</span>
<span class='co'>#plot(x, a)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>z</span>, <span class='va'>a</span><span class='op'>)</span>

<span class='co'># actual outlier, but maybe not obvious if PCA isn't applied</span>
<span class='va'>outlier</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>0.6</span>, <span class='fl'>10</span>, <span class='fl'>8</span><span class='op'>)</span>
<span class='co'># this one should appear to be an outlier (but only if PCA is applied)</span>
<span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>,
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>, 
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, pca <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'># this one should be within the 80% area</span>
<span class='va'>outlier</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>30</span>, <span class='fl'>5</span><span class='op'>)</span>
<span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>, 
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>, 
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, pca <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># this one should be an obvious outlier no matter what</span>
<span class='va'>outlier</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='op'>-</span><span class='fl'>2</span>, <span class='fl'>20</span>, <span class='fl'>18</span><span class='op'>)</span>
<span class='co'># this one should be outside the 80% area</span>
<span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>, 
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='fu'>testMultivarOutlierHDR</span><span class='op'>(</span>dataMatrix <span class='op'>=</span> <span class='va'>data</span>, 
  outlier <span class='op'>=</span> <span class='va'>outlier</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span>, pca <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Less than 10 observations are given as input - estimates of the highest density region may be very imprecise</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, David Bapst, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


