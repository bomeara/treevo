<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summarize Posterior Distribution for a Free Parameter — summarizePosterior • TreEvo</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Summarize Posterior Distribution for a Free Parameter — summarizePosterior" />

<meta property="og:description" content="This function summarizes the distribution of parameter estimates from
the posterior of an ABC analysis sing the doRun functions in TreEvo, for all
freely varying parameters. Only the final generation is considered. This summary includes
the mean, standard deviation and Highest Posterior Density (at a 0.8 alpha) for each parameter." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/treevo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarize Posterior Distribution for a Free Parameter</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/treevo/blob/master/R/summarizePosterior.R'><code>R/summarizePosterior.R</code></a></small>
    <div class="hidden name"><code>summarizePosterior.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function summarizes the distribution of parameter estimates from
the posterior of an ABC analysis sing the <code>doRun</code> functions in <code>TreEvo</code>, for all
freely varying parameters. Only the final generation is considered. This summary includes
the mean, standard deviation and Highest Posterior Density (at a 0.8 alpha) for each parameter.</p>
    
    </div>

    <pre class="usage"><span class='fu'>summarizePosterior</span>(<span class='no'>particleDataFrame</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>coda</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verboseMultimodal</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>particleDataFrame</th>
      <td><p>A <code>particleDataFrame</code> object, as
found among the output from <code><a href='doRun.html'>doRun</a></code> functions.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The threshold used for defining the highest density frequency
cut-off. If the highest density interval is applied to a Bayesian MCMC
posterior sample, then the interval is effectively calculated for this
value as a posterior probability density.</p></td>
    </tr>
    <tr>
      <th>coda</th>
      <td><p>Default is <code>FALSE</code>. If <code>TRUE</code>, unimodal highest density regions will
instead be calculated using <code>HPDinterval</code> from package <code>coda</code>, which is
similar to the function <code>quantile</code> in that it calculates only a single interval.</p></td>
    </tr>
    <tr>
      <th>verboseMultimodal</th>
      <td><p>If <code>TRUE</code>, the function will print a message
indicating when the inferred highest density interval is discontinuous, and
thus likely reflects that the supplied data is multimodal.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>density</code>. 
A user may want to mess with this to adjust bandwidth, et cetera.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list, wherein each element of the list is secondary list containing
the weighted mean, standard deviation, and a matrix giving the highest density
intervals (e.g. the highest posterior density intervals). Because posterior
estimates of parameter values may be multimodal, multiple sets of bounds
may be reported for complex posterior distributions, which each constitute one 
row of the output matrix. See <code><a href='highestDensityInterval.html'>highestDensityInterval</a></code> for details.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>This function is essentially a wrapper for independently applying 
a few summary statistics and applying
<code><a href='highestDensityInterval.html'>highestDensityInterval</a></code> to multiple parameter estimates, taken from
the last generation of an ABC analysis in <code>TreEvo</code>. As each parameter
is handled independently, the returned HPD intervals may not properly account
for covariation among parameter estimates from the posterior. If testing
whether a given observation is within a given density of the posterior or
not, please look at function <code><a href='testMultivarOutlierHDR.html'>testMultivarOutlierHDR</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># example with output from doRun_prc</span>
<span class='fu'>data</span>(<span class='no'>simRunExample</span>)

<span class='co'># alpha = 0.95</span>
<span class='fu'>summarizePosterior</span>(<span class='no'>results</span><span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='no'>particleDataFrame</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.95</span>)</div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.661602
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.1985405
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.95 UpperBound__alpha=0.95
#&gt; [1,]              9.292509                10.0967
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.04162821
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02389411
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.95 UpperBound__alpha=0.95
#&gt; [1,]          -0.006581125             0.08965948
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># you might be tempted to use alphas like 95%, but with bayesian statistics</span>
<span class='co'># we often don't sample the distribution well enough to know</span>
<span class='co'># its shape to exceeding detail. alpha = 0.8 may be more reasonable.</span>
<span class='fu'>summarizePosterior</span>(<span class='no'>results</span><span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='no'>particleDataFrame</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)</div><div class='output co'>#&gt; <span class='message'>Inferred highest density intervals are discontinuous, suggesting data may have multiple modes</span></div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.661602
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.1985405
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.8 UpperBound__alpha=0.8
#&gt; [1,]             9.368550              9.845534
#&gt; [2,]             9.969964             10.050613
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.04162821
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02389411
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.8 UpperBound__alpha=0.8
#&gt; [1,]          0.005704909            0.07386315
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># or even better, for coverage purposes, maybe 0.5</span>
<span class='fu'>summarizePosterior</span>(<span class='no'>results</span><span class='kw'>[[</span><span class='fl'>1</span>]]$<span class='no'>particleDataFrame</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.661602
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.1985405
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.5 UpperBound__alpha=0.5
#&gt; [1,]             9.506806              9.725712
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.04162821
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02389411
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.5 UpperBound__alpha=0.5
#&gt; [1,]           0.02501153            0.06245469
#&gt; 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
David W Bapst

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, Barb Banbury, David Bapst.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

