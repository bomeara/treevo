<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summarize Posterior Distribution for a Free Parameter — summarizePosterior • TreEvo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Summarize Posterior Distribution for a Free Parameter — summarizePosterior" />
<meta property="og:description" content="This function summarizes the distribution of parameter
estimates from the posterior of an ABC analysis using the
doRun functions in TreEvo, for all
freely varying parameters. Only the final
generation is considered. This summary includes
the mean, standard deviation and Highest Posterior
Density (at a 0.8 alpha) for each parameter." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/TreEvo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarize Posterior Distribution for a Free Parameter</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/TreEvo/blob/master/R/summarizePosterior.R'><code>R/summarizePosterior.R</code></a></small>
    <div class="hidden name"><code>summarizePosterior.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function summarizes the distribution of parameter
estimates from the posterior of an ABC analysis using the
<code>doRun</code> functions in <code>TreEvo</code>, for all
freely varying parameters. Only the final
generation is considered. This summary includes
the mean, standard deviation and Highest Posterior
Density (at a 0.8 alpha) for each parameter.</p>
    </div>

    <pre class="usage"><span class='fu'>summarizePosterior</span><span class='op'>(</span>
  <span class='va'>particleDataFrame</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.8</span>,
  coda <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verboseMultimodal <span class='op'>=</span> <span class='cn'>TRUE</span>,
  stopIfFlat <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>particleDataFrame</th>
      <td><p>A <code>particleDataFrame</code> object, as
found among the output from <code><a href='doRun.html'>doRun</a></code> functions.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The threshold used for defining the highest density frequency
cut-off. If the highest density interval is applied to a Bayesian MCMC
posterior sample, then the interval is effectively calculated for this
value as a posterior probability density.</p></td>
    </tr>
    <tr>
      <th>coda</th>
      <td><p>Default is <code>FALSE</code>. If <code>TRUE</code>, unimodal highest density regions will
instead be calculated using <code>HPDinterval</code> from package <code>coda</code>, which is
similar to the function <code>quantile</code> in that it calculates only a single interval.</p></td>
    </tr>
    <tr>
      <th>verboseMultimodal</th>
      <td><p>If <code>TRUE</code>, the function will print a message
indicating when the inferred highest density interval is discontinuous, and
thus likely reflects that the supplied data is multimodal.</p></td>
    </tr>
    <tr>
      <th>stopIfFlat</th>
      <td><p>If <code>TRUE</code> (the default), the function will terminate
and return an error if the distribution appears to be flat, with a
high number of tied values in the posterior. 
If <code>FALSE</code>, the function will instead attempt to move forward,
while returning a warning instead. The latter option is
mainly implemented so internal calls to <code>highestDensityInterval</code>
do not block otherwise long-running analyses.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code>. 
A user may want to mess with this to adjust bandwidth, et cetera.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list, wherein each element of the list is secondary list containing
the weighted mean, standard deviation, and a matrix giving the highest density
intervals (e.g. the highest posterior density intervals). Because posterior
estimates of parameter values may be multimodal, multiple sets of bounds
may be reported for complex posterior distributions, which each constitute one 
row of the output matrix. See <code><a href='highestDensityInterval.html'>highestDensityInterval</a></code> for details.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>This function is essentially a wrapper for independently applying 
a few summary statistics and applying
<code><a href='highestDensityInterval.html'>highestDensityInterval</a></code> to multiple parameter estimates, taken from
the last generation of an ABC analysis in <code>TreEvo</code>. As each parameter
is handled independently, the returned HPD intervals may not properly account
for covariation among parameter estimates from the posterior. If testing
whether a given observation is within a given density of the posterior or
not, please look at function <code><a href='testMultivarOutlierHDR.html'>testMultivarOutlierHDR</a></code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>David W Bapst</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># example with output from doRun_prc</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>simRunExample</span><span class='op'>)</span>

<span class='co'># alpha = 0.95</span>
<span class='fu'>summarizePosterior</span><span class='op'>(</span>
     <span class='va'>resultsBMExample</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>particleDataFrame</span>, 
     alpha <span class='op'>=</span> <span class='fl'>0.95</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.772155
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.126498
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.95 UpperBound_alpha=0.95
#&gt; [1,]              9.478273              10.01189
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.03650089
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02126776
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.95 UpperBound_alpha=0.95
#&gt; [1,]          -0.005969742            0.07973995
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># you might be tempted to use alphas like 95%, </span>
    <span class='co'># but with bayesian statistics</span>
<span class='co'># we often don't sample the distribution well enough to know</span>
    <span class='co'># its shape to exceeding detail. </span>
    <span class='co'># alpha = 0.8 may be more reasonable.</span>
<span class='fu'>summarizePosterior</span><span class='op'>(</span>
    <span class='va'>resultsBMExample</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>particleDataFrame</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.772155
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.126498
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.8 UpperBound_alpha=0.8
#&gt; [1,]             9.593231             9.941538
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.03650089
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02126776
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.8 UpperBound_alpha=0.8
#&gt; [1,]          0.004411246           0.06350302
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># or even better, for coverage purposes, maybe 0.5</span>
<span class='fu'>summarizePosterior</span><span class='op'>(</span>
    <span class='va'>resultsBMExample</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>particleDataFrame</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $starting_1
#&gt; $starting_1$mean
#&gt; [1] 9.772155
#&gt; 
#&gt; $starting_1$sd
#&gt; [1] 0.126498
#&gt; 
#&gt; $starting_1$HPD
#&gt;      LowerBound_alpha=0.5 UpperBound_alpha=0.5
#&gt; [1,]             9.728779             9.902075
#&gt; 
#&gt; 
#&gt; $intrinsic_1
#&gt; $intrinsic_1$mean
#&gt; [1] 0.03650089
#&gt; 
#&gt; $intrinsic_1$sd
#&gt; [1] 0.02126776
#&gt; 
#&gt; $intrinsic_1$HPD
#&gt;      LowerBound_alpha=0.5 UpperBound_alpha=0.5
#&gt; [1,]           0.02091435           0.05498529
#&gt; 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, David Bapst, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


