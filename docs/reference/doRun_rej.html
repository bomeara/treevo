<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Approximate Bayesian computation for comparative methods-Rejection — doRun_rej • TreEvo</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">TreEvo</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/treevo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Approximate Bayesian computation for comparative methods-Rejection</h1>
    </div>

    
    <p>Starts the abc-rejection run</p>
    

    <pre><span class='fu'>doRun_rej</span>(<span class='no'>phy</span>, <span class='no'>traits</span>, <span class='no'>intrinsicFn</span>, <span class='no'>extrinsicFn</span>, <span class='no'>startingPriorsValues</span>,
  <span class='no'>startingPriorsFns</span>, <span class='no'>intrinsicPriorsValues</span>, <span class='no'>intrinsicPriorsFns</span>,
  <span class='no'>extrinsicPriorsValues</span>, <span class='no'>extrinsicPriorsFns</span>, <span class='kw'>startingValuesGuess</span> <span class='kw'>=</span> <span class='fu'>c</span>(),
  <span class='kw'>intrinsicStatesGuess</span> <span class='kw'>=</span> <span class='fu'>c</span>(), <span class='kw'>extrinsicStatesGuess</span> <span class='kw'>=</span> <span class='fu'>c</span>(),
  <span class='kw'>TreeYears</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>standardDevFactor</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>StartSims</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>jobName</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>abcTolerance</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>multicore</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>coreLimit</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>checkpointFile</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>checkpointFreq</span> <span class='kw'>=</span> <span class='fl'>24</span>, <span class='kw'>validation</span> <span class='kw'>=</span> <span class='st'>"CV"</span>,
  <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>variance.cutoff</span> <span class='kw'>=</span> <span class='fl'>95</span>, <span class='kw'>savesims</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>niter.goal</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>generation.time</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>phy</th>
      <td><p>Tree (Phylogenetic tree in phylo format)</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>data matrix with rownames equal to phy</p></td>
    </tr>
    <tr>
      <th>intrinsicFn</th>
      <td><p>Name of (previously-defined) function that governs how
traits evolve within a lineage, regardless of the states of other taxa</p></td>
    </tr>
    <tr>
      <th>extrinsicFn</th>
      <td><p>Name of (previously-defined) function that governs how
traits evolve within a lineage, based on the internal state and the states
of other taxa</p></td>
    </tr>
    <tr>
      <th>startingPriorsValues</th>
      <td><p>Matrix with ncol=number of states (characters)
at root and nrow=2 (two parameters to pass to prior distribution)</p></td>
    </tr>
    <tr>
      <th>startingPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for root states: can be one of fixed, uniform, normal, lognormal, gamma,
exponential</p></td>
    </tr>
    <tr>
      <th>intrinsicPriorsValues</th>
      <td><p>Matrix with ncol=number of parameters to pass
to the intrinsic function and nrow=2 (two parameters to pass to prior
distribution)</p></td>
    </tr>
    <tr>
      <th>intrinsicPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for intrinsic function parameters: can be one of fixed, uniform, normal,
lognormal, gamma, exponential</p></td>
    </tr>
    <tr>
      <th>extrinsicPriorsValues</th>
      <td><p>Matrix with ncol=number of parameters to pass
to the extrinsic function and nrow=2 (two parameters to pass to prior
distribution)</p></td>
    </tr>
    <tr>
      <th>extrinsicPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for extrinsic function parameters: can be one of fixed, uniform, normal,
lognormal, gamma, exponential</p></td>
    </tr>
    <tr>
      <th>startingValuesGuess</th>
      <td><p>Optional guess of starting values</p></td>
    </tr>
    <tr>
      <th>intrinsicStatesGuess</th>
      <td><p>Optional guess of intrinsic values</p></td>
    </tr>
    <tr>
      <th>extrinsicStatesGuess</th>
      <td><p>Optional guess of extrinsic values</p></td>
    </tr>
    <tr>
      <th>TreeYears</th>
      <td><p>Unit length of phy</p></td>
    </tr>
    <tr>
      <th>standardDevFactor</th>
      <td><p>Standard deviation for mutating states</p></td>
    </tr>
    <tr>
      <th>StartSims</th>
      <td><p>Number of simulations</p></td>
    </tr>
    <tr>
      <th>jobName</th>
      <td><p>Optional job name</p></td>
    </tr>
    <tr>
      <th>abcTolerance</th>
      <td><p>Proportion of accepted simulations</p></td>
    </tr>
    <tr>
      <th>multicore</th>
      <td><p>If TRUE, initial simulations will be split among coreLimit
nodes</p></td>
    </tr>
    <tr>
      <th>coreLimit</th>
      <td><p>Number of cores for initial simulations</p></td>
    </tr>
    <tr>
      <th>checkpointFile</th>
      <td><p>Optional file name for checkpointing simulations</p></td>
    </tr>
    <tr>
      <th>checkpointFreq</th>
      <td><p>Saving frequency for checkpointing</p></td>
    </tr>
    <tr>
      <th>validation</th>
      <td><p>Cross Validation procedure for abc</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>scale for pls.model.list</p></td>
    </tr>
    <tr>
      <th>variance.cutoff</th>
      <td><p>variance cutoff for pls.model.list</p></td>
    </tr>
    <tr>
      <th>savesims</th>
      <td><p>option to save individual simulations</p></td>
    </tr>
    <tr>
      <th>niter.goal</th>
      <td><p>Adjust number of starting points for Geiger to return the best parameter estimates this number of times on average</p></td>
    </tr>
    <tr>
      <th>generation.time</th>
      <td><p>The number of years per generation. This sets the coarseness of the simulation; if it's set to 1000, for example, the population moves every 1000 years.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>input.data</dt><dd><p>Input variables: jobName, number of taxa, nrepSim,
treeYears, epsilonProportion, epsilonMultiplier, nStepsPRC, numParticles,
standardDevFactor</p></dd> <dt>PriorMatrix</dt><dd><p>Matrix of prior distributions</p></dd>
<dt>phy</dt><dd><p>Input phylogeny</p></dd> <dt>traits</dt><dd><p>Input traits</p></dd>
<dt>trueFreeValuesANDSummaryValues</dt><dd><p>Parameter estimates and summary stats
from all sims</p></dd> <dt>simTime</dt><dd><p>Processor time for simulations</p></dd>
<dt>whichVip</dt><dd><p>Matrix of vip summary statistics for each free parameter</p></dd>
<dt>abcDistancesRaw</dt><dd><p>Euclidean distances for each simulation and free
parameter</p></dd> <dt>particleDataFrame</dt><dd><p>DataFrame with information from each
simulation, including generation, attempt, id, parentid, distance, weight,
and parameter states</p></dd> <dt>CredInt</dt><dd><p>Credible Interval calculation for each
free parameter of the final generation</p></dd> <dt>HPD</dt><dd><p>Highest Posterior Density
calculation each free parameter of the final generation</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function performs an abc-rejection analysis using an input phylogeny
(phy), character data set (traits), models (intrinsicFn, extrinsicFn), and
priors (startingPriorsValues, startingPriorsFns, intrinsicPriorsValues,
intrinsicPriorsFns, extrinsicPriorsValues, extrinsicPriorsFns). Pulling from
the priors, it performs StartSims simulations. This set of simulations are
boxcox transformed and a pls regression is performed for each free parameter
to determine the most informative summary statistics (vipthresh). The
euclidean distance of each initial simulation's vip summary stats to the
input data is calculated, and those that fall under the abcTolerance are
kept as accepted particles. These describe the posterior distributions of
parameters.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>O'Meara and Banbury, unpublished; Sisson et al. 2007, Wegmann et
al. 2009</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>data</span>(<span class='no'>simData</span>)

<span class='co'>#c&lt;-doRun_rej( #make sure priors are uniform with this one!</span>
<span class='co'>#	phy=simPhy,</span>
<span class='co'>#	traits=simChar,</span>
<span class='co'>#	intrinsicFn=brownianIntrinsic,</span>
<span class='co'>#	extrinsicFn=nullExtrinsic,</span>
<span class='co'>#	startingPriorsFns="normal",</span>
<span class='co'>#	startingPriorsValues=matrix(c(mean(char[,1]), sd(char[,1]))),</span>
<span class='co'>#	intrinsicPriorsFns=c("exponential"),</span>
<span class='co'>#	intrinsicPriorsValues=matrix(c(10, 10), nrow=2, byrow=FALSE), #grep for normal in pkg</span>
<span class='co'>#	extrinsicPriorsFns=c("fixed"),</span>
<span class='co'>#	extrinsicPriorsValues=matrix(c(0, 0), nrow=2, byrow=FALSE),</span>
<span class='co'>#	StartSims=1000,</span>
<span class='co'>#	jobName="run_c",</span>
<span class='co'>#	abcTolerance=0.05,</span>
<span class='co'>#	multicore=F,</span>
<span class='co'>#	coreLimit=1</span>
<span class='co'>#)</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Brian O'Meara and Barb Banbury

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
