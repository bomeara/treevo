<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extrinsic Character Evolution Models — extrinsicModels • TreEvo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extrinsic Character Evolution Models — extrinsicModels" />
<meta property="og:description" content="Functions describing various models of 'extrinsic' evolution (i.e. evolutionary processes
dependent on factors extrinsic to the evolving lineage, such as environmental change, or
other evolving lineages that interact with the lineage in question (competitors, predators, etc)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/TreEvo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extrinsic Character Evolution Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/TreEvo/blob/master/R/abcmodels.extrinsic.R'><code>R/abcmodels.extrinsic.R</code></a></small>
    <div class="hidden name"><code>extrinsicModels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions describing various models of 'extrinsic' evolution (i.e. evolutionary processes
dependent on factors extrinsic to the evolving lineage, such as environmental change, or
other evolving lineages that interact with the lineage in question (competitors, predators, etc).</p>
    </div>

    <pre class="usage"><span class='fu'>nullExtrinsic</span><span class='op'>(</span><span class='va'>params</span>, <span class='va'>selfstates</span>, <span class='va'>otherstates</span>, <span class='va'>timefrompresent</span><span class='op'>)</span>

<span class='fu'>nearestNeighborDisplacementExtrinsic</span><span class='op'>(</span>
  <span class='va'>params</span>,
  <span class='va'>selfstates</span>,
  <span class='va'>otherstates</span>,
  <span class='va'>timefrompresent</span>
<span class='op'>)</span>

<span class='fu'>everyoneDisplacementExtrinsic</span><span class='op'>(</span><span class='va'>params</span>, <span class='va'>selfstates</span>, <span class='va'>otherstates</span>, <span class='va'>timefrompresent</span><span class='op'>)</span>

<span class='fu'>ExponentiallyDecayingPushExtrinsic</span><span class='op'>(</span>
  <span class='va'>params</span>,
  <span class='va'>selfstates</span>,
  <span class='va'>otherstates</span>,
  <span class='va'>timefrompresent</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>params</th>
      <td><p>A vector containing input parameters for the given model (see <em>Description</em> below on what parameters).</p></td>
    </tr>
    <tr>
      <th>selfstates</th>
      <td><p>Vector of current trait values for the population of
interest. May be multiple for some models, but generally expected to be
only a single value. Multivariate <code>TreEvo</code> is not yet supported.</p></td>
    </tr>
    <tr>
      <th>otherstates</th>
      <td><p>Matrix of current trait values for all concurrent taxa/populations other
than the one of interest, with one row for each taxon, and a column for each trait.
May be multiple states per taxa/populations for some models, but generally expected to be
only a single value. Multivariate <code>TreEvo</code> is not yet supported.</p></td>
    </tr>
    <tr>
      <th>timefrompresent</th>
      <td><p>The amount of time from the present - generally ignored except for time-dependent models.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of values representing character displacement of that lineage over a single time step.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following extrinsic models are:</p>
<p><code>nullExtrinsic</code> describes a model of no extrinsic character change.
It has no parameters, really.</p>
<p><code>nearestNeighborDisplacementExtrinsic</code> describes a model of extrinsic trait evolution where character
values of a focal taxon depend on the values of closest relatives on the tree (e.g. competitive exclusion).
The input parameters for this model are:
<code>nearestNeighborDisplacementExtrinsic</code> with parameters <code>params = sigma, springK, maximumForce</code></p>
<p><code>everyoneDisplacementExtrinsic</code> describes a model of extrinsic trait evolution where the character
values of a focal taxon depend on the values of all co-extant relatives on the simulated tree.
The input parameters for this model are:
<code>everyoneDisplacementExtrinsic</code> with parameters <code>params = sigma, springK, maximumForce</code></p>
<p><code>ExponentiallyDecayingPushExtrinsic</code> describes a model of extrinsic trait evolution where the character
values of a focal taxon is 'pushed' away from other taxa with similar values, but the force of that 'push'
exponentially decays as lineages diverge and their character values become less similar.
The input parameters for this model are:
<code>ExponentiallyDecayingPushExtrinsic</code> with parameters <code>params = sigma, maximumForce, halfDistance</code></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Intrinsic models are described at <code><a href='intrinsicModels.html'>intrinsicModels</a></code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Brian O'Meara and Barb Banbury</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'># Examples of simulations with various extrinsic models (and null intrinsic model)</span>
<span class='va'>tree</span> <span class='op'>&lt;-</span> <span class='fu'>rcoal</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span>
<span class='co'># get realistic edge lengths</span>
<span class='va'>tree</span><span class='op'>$</span><span class='va'>edge.length</span> <span class='op'>&lt;-</span> <span class='va'>tree</span><span class='op'>$</span><span class='va'>edge.length</span><span class='op'>*</span><span class='fl'>20</span>

<span class='co'>#No trait evolution except due to</span>
       <span class='co'># character displacement due to nearest neighbor taxon</span>
<span class='va'>char</span> <span class='op'>&lt;-</span> <span class='fu'><a href='doSimulation.html'>doSimulation</a></span><span class='op'>(</span>
    phy <span class='op'>=</span> <span class='va'>tree</span>, 
    intrinsicFn <span class='op'>=</span> <span class='va'>nullIntrinsic</span>, 
    extrinsicFn <span class='op'>=</span> <span class='va'>nearestNeighborDisplacementExtrinsic</span>, 
    startingValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, <span class='co'>#root state</span>
    intrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
    extrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, 
 generation.time <span class='op'>=</span> <span class='fl'>100000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: You have only 22 timeSteps on the shortest branch in this dataset</span>
#&gt; <span class='warning'> but should probably have a lot more if you expect change on this branch.</span>
#&gt; <span class='warning'> Please consider decreasing timeStep to no more than 0.0016</span></div><div class='input'>
<span class='co'>#Similarly, no trait evolution except due to</span>
       <span class='co'># character displacement from all other taxa in the clade</span>
<span class='va'>char</span> <span class='op'>&lt;-</span> <span class='fu'><a href='doSimulation.html'>doSimulation</a></span><span class='op'>(</span>
    phy <span class='op'>=</span> <span class='va'>tree</span>, 
    intrinsicFn <span class='op'>=</span> <span class='va'>nullIntrinsic</span>, 
    extrinsicFn <span class='op'>=</span> <span class='va'>everyoneDisplacementExtrinsic</span>, 
    startingValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, <span class='co'>#root state</span>
    intrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
    extrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span>, 
    generation.time <span class='op'>=</span> <span class='fl'>100000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: You have only 22 timeSteps on the shortest branch in this dataset</span>
#&gt; <span class='warning'> but should probably have a lot more if you expect change on this branch.</span>
#&gt; <span class='warning'> Please consider decreasing timeStep to no more than 0.0016</span></div><div class='input'>
<span class='co'># A variant where force of character displacement decays exponentially</span>
        <span class='co'># as lineages become more different</span>
<span class='va'>char</span> <span class='op'>&lt;-</span> <span class='fu'><a href='doSimulation.html'>doSimulation</a></span><span class='op'>(</span>
    phy <span class='op'>=</span> <span class='va'>tree</span>, 
    intrinsicFn <span class='op'>=</span> <span class='va'>nullIntrinsic</span>, 
    extrinsicFn <span class='op'>=</span> <span class='va'>ExponentiallyDecayingPushExtrinsic</span>, 
    startingValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, <span class='co'>#root state</span>
    intrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
    extrinsicValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>2</span><span class='op'>)</span>, 
    generation.time <span class='op'>=</span> <span class='fl'>100000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: You have only 22 timeSteps on the shortest branch in this dataset</span>
#&gt; <span class='warning'> but should probably have a lot more if you expect change on this branch.</span>
#&gt; <span class='warning'> Please consider decreasing timeStep to no more than 0.0016</span></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, David Bapst, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


