<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate data for initial TreEvo analysis — simulateWithPriors • TreEvo</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate data for initial TreEvo analysis — simulateWithPriors" />
<meta property="og:description" content="The simulateWithPriors function pulls parameters from prior
distributions and conducts a single simulation of continuous trait evolution
(using the doSimulation function),
returning useful summary statistics for ABC.
parallelSimulateWithPriors is a wrapper function for
simulateWithPriors that allows for multithreading and
checkpointing. This family of functions is mostly used as
internal components, generating simulations within ABC analyses
using the doRun functions. See Note below." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreEvo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.22.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/treevo_ABC_vignette.html">Analyzing Trait Evolution with Approximate Bayesian Computation in TreEvo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bomeara/TreEvo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate data for initial TreEvo analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/bomeara/TreEvo/blob/master/R/simulateWithPriors.R'><code>R/simulateWithPriors.R</code></a></small>
    <div class="hidden name"><code>simulateWithPriors.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>simulateWithPriors</code> function pulls parameters from prior
distributions and conducts a single simulation of continuous trait evolution
(using the <code><a href='doSimulation.html'>doSimulation</a></code> function),
returning useful summary statistics for ABC.
<code>parallelSimulateWithPriors</code> is a wrapper function for
<code>simulateWithPriors</code> that allows for multithreading and
checkpointing. This family of functions is mostly used as
internal components, generating simulations within ABC analyses
using the <code><a href='doRun.html'>doRun</a></code> functions. See <em>Note</em> below.</p>
    </div>

    <pre class="usage"><span class='fu'>simulateWithPriors</span><span class='op'>(</span>
  phy <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>intrinsicFn</span>,
  <span class='va'>extrinsicFn</span>,
  <span class='va'>startingPriorsFns</span>,
  <span class='va'>startingPriorsValues</span>,
  <span class='va'>intrinsicPriorsFns</span>,
  <span class='va'>intrinsicPriorsValues</span>,
  <span class='va'>extrinsicPriorsFns</span>,
  <span class='va'>extrinsicPriorsValues</span>,
  generation.time <span class='op'>=</span> <span class='fl'>1000</span>,
  TreeYears <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'>branching.times</span><span class='op'>(</span><span class='va'>phy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>1e+06</span>,
  timeStep <span class='op'>=</span> <span class='cn'>NULL</span>,
  giveUpAttempts <span class='op'>=</span> <span class='fl'>10</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  checks <span class='op'>=</span> <span class='cn'>TRUE</span>,
  taxonDF <span class='op'>=</span> <span class='cn'>NULL</span>,
  freevector <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>parallelSimulateWithPriors</span><span class='op'>(</span>
  <span class='va'>nrepSim</span>,
  <span class='va'>multicore</span>,
  <span class='va'>coreLimit</span>,
  <span class='va'>phy</span>,
  <span class='va'>intrinsicFn</span>,
  <span class='va'>extrinsicFn</span>,
  <span class='va'>startingPriorsFns</span>,
  <span class='va'>startingPriorsValues</span>,
  <span class='va'>intrinsicPriorsFns</span>,
  <span class='va'>intrinsicPriorsValues</span>,
  <span class='va'>extrinsicPriorsFns</span>,
  <span class='va'>extrinsicPriorsValues</span>,
  generation.time <span class='op'>=</span> <span class='fl'>1000</span>,
  TreeYears <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'>branching.times</span><span class='op'>(</span><span class='va'>phy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>1e+06</span>,
  timeStep <span class='op'>=</span> <span class='cn'>NULL</span>,
  checkpointFile <span class='op'>=</span> <span class='cn'>NULL</span>,
  checkpointFreq <span class='op'>=</span> <span class='fl'>24</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  checkTimeStep <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verboseNested <span class='op'>=</span> <span class='cn'>FALSE</span>,
  freevector <span class='op'>=</span> <span class='cn'>NULL</span>,
  taxonDF <span class='op'>=</span> <span class='cn'>NULL</span>,
  giveUpAttempts <span class='op'>=</span> <span class='fl'>10</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>phy</th>
      <td><p>A phylogenetic tree, in package <code>ape</code>'s <code>phylo</code> format.</p></td>
    </tr>
    <tr>
      <th>intrinsicFn</th>
      <td><p>Name of (previously-defined) function that governs how
traits evolve within a lineage, regardless of the trait values of other taxa.</p></td>
    </tr>
    <tr>
      <th>extrinsicFn</th>
      <td><p>Name of (previously-defined) function that governs how
traits evolve within a lineage, based on their own
('internal') trait vlaue and the trait values
of other taxa.</p></td>
    </tr>
    <tr>
      <th>startingPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for root states: can be one of
<code>"fixed"</code>, <code>"uniform"</code>, <code>"normal"</code>, 
<code>"lognormal"</code>, <code>"gamma"</code>, <code>"exponential"</code>.</p></td>
    </tr>
    <tr>
      <th>startingPriorsValues</th>
      <td><p>A list of the same length as
the number of prior distributions specified in
<code>startingPriorsFns</code> (for starting values, this should
be one prior function specified for each trait
- thus one for most univariate trait analyses), with each
element of the list a vector the same length
as the appropriate number of parameters for that prior distribution
(1 for <code>"fixed"</code>, 2 for <code>"uniform"</code>, 2 for <code>"normal"</code>,
2 for <code>"lognormal"</code>, 2 for <code>"gamma"</code>, 1 for <code>"exponential"</code>).</p></td>
    </tr>
    <tr>
      <th>intrinsicPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for intrinsic function parameters: can be one of
<code>"fixed"</code>, <code>"uniform"</code>, <code>"normal"</code>, 
<code>"lognormal"</code>, <code>"gamma"</code>, <code>"exponential"</code>.</p></td>
    </tr>
    <tr>
      <th>intrinsicPriorsValues</th>
      <td><p>A list of the same length
as the number of prior distributions specified
in <code>intrinsicPriorsFns</code> (one prior function specified
for each parameter in the intrinsic model),
with each element of the list a vector the same length#
as the appropriate number of parameters for that prior distribution
(1 for <code>"fixed"</code>, 2 for <code>"uniform"</code>, 2 for <code>"normal"</code>,
2 for <code>"lognormal"</code>, 2 for <code>"gamma"</code>, 1 for <code>"exponential"</code>).</p></td>
    </tr>
    <tr>
      <th>extrinsicPriorsFns</th>
      <td><p>Vector containing names of prior distributions to
use for extrinsic function parameters: can be one of
<code>"fixed"</code>, <code>"uniform"</code>, <code>"normal"</code>, 
<code>"lognormal"</code>, <code>"gamma"</code>, <code>"exponential"</code>.</p></td>
    </tr>
    <tr>
      <th>extrinsicPriorsValues</th>
      <td><p>A list of the same length as
the number of prior distributions specified in <code>extrinsicPriorsFns</code> 
(one prior function specified for each parameter in the extrinsic model),
with each element of the list a vector the same length as the appropriate
number of parameters for that prior distribution
(1 for <code>"fixed"</code>, 2 for <code>"uniform"</code>, 2 for <code>"normal"</code>,
2 for <code>"lognormal"</code>, 2 for <code>"gamma"</code>, 1 for <code>"exponential"</code>).</p></td>
    </tr>
    <tr>
      <th>generation.time</th>
      <td><p>The number of years per generation.
This sets the coarseness of the simulation; if it's set to 1000, 
for example, the population's trait values change every 1000
calendar years. Note that this is in calendar years (see description
for argument <code>TreeYears</code>), and not in millions of years
(as is typical for dated trees in macroevolutionary studies).
Thus, if a branch is 1 million-year time-unit long, and a
user applies the default <code>generation.time = 1000</code>, 
then 1000 evolutionary changes will be simulated along that branch.
See documentation for <code><a href='doSimulation.html'>doSimulation</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>TreeYears</th>
      <td><p>The amount of calendar time from the root
to the furthest tip. Most trees in macroevolutionary studies are dated with
branch lengths in units of millions of years, and thus the
default for this argument is <code>max(branching.times(phy)) * 1e6</code>.
If your tree has the most recent tip at time zero (i.e.,
the modern day), this would be the same as the root age of the tree. If your
branch lengths are not in millions of years, you should
alter this argument. Otherwise, leave this argument alone.
See documentation for <code><a href='doSimulation.html'>doSimulation</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>timeStep</th>
      <td><p>This value corresponds to the length
of intervals between discrete evolutionary events ('generations')
simulated along branches, relative to a rescaled tree
where the root to furthest tip distance is 1. For example, 
<code>timeStep = 0.01</code> of would mean 100 (i.e., 1 / 0.01)
evolutionary changes would be expected to occur from
the root to the furthest tip. (Note that the real number
simulated will be much less, because simulations start
over at each branching node.) Ideally, <code>timeStep</code>
(or its effective value, via other arguments) should be
as short as is computationally possible.
Typically <code>NULL</code> by default and
determined internally as follows: <code>timeStep = generation.time / TreeYears</code>.
Can be provided a value as an alternative to using arguments <code>generation.time</code>
and <code>TreeYears</code>, which would then be overridden.
See documentation for <code><a href='doSimulation.html'>doSimulation</a></code> for further details.</p></td>
    </tr>
    <tr>
      <th>giveUpAttempts</th>
      <td><p>Value for when to stop the
analysis if <code>NA</code> values are present.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, gives messages about how
the simulation is progessing via <code>message</code>.</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>If <code>TRUE</code>, checks inputs for consistency.
This activity is skipped (<code>checks = FALSE</code>)
when run in parallel by <code>parallelSimulateWithPriors</code>,
and instead is only checked once. This
argument also controls whether <code>simulateWithPriors</code>
assigns <code>freevector</code> as an attribute to the
output produced.</p></td>
    </tr>
    <tr>
      <th>taxonDF</th>
      <td><p>A data.frame containing data on nodes (both
tips and internal nodes) output by various internal functions.
Can be supplied as input to spead up repeated calculations, but by default is
<code>NULL</code>, which instead forces a calculation from input <code>phy</code>.</p></td>
    </tr>
    <tr>
      <th>freevector</th>
      <td><p>A logical vector
(with length equal to the number of parameters),
indicating free (<code>TRUE</code>) and
fixed (<code>FALSE</code>) parameters.</p></td>
    </tr>
    <tr>
      <th>nrepSim</th>
      <td><p>Number of replicated simulations to run.</p></td>
    </tr>
    <tr>
      <th>multicore</th>
      <td><p>Whether to use multicore, default is <code>FALSE</code>.
If <code>TRUE</code>, one of two suggested packages must be installed,
either <code>doMC</code> (for UNIX systems) or
<code>doParallel</code> (for Windows), which are used to activate multithreading.
If neither package is installed, this function will fail if <code>multicore = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>coreLimit</th>
      <td><p>Maximum number of cores to be used.</p></td>
    </tr>
    <tr>
      <th>checkpointFile</th>
      <td><p>Optional file name for checkpointing simulations</p></td>
    </tr>
    <tr>
      <th>checkpointFreq</th>
      <td><p>Saving frequency for checkpointing</p></td>
    </tr>
    <tr>
      <th>checkTimeStep</th>
      <td><p>If <code>TRUE</code>, warnings will be issued if <code>TimeStep</code> is too short.</p></td>
    </tr>
    <tr>
      <th>verboseNested</th>
      <td><p>Should looped runs of <code>simulateWithPriors</code> be verbose?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>simulateWithPriors</code> returns a
vector of <code>trueFreeValues</code>, the true generating parameters
used in the simulation (a set of values as long as
the number of freely varying parameters), concatenated with
a set of summary statistics for the simulation.</p>
<p>Function <code>parallelSimulateWithPriors</code> returns a matrix
of such vectors bound together, with each row representing
a different simulation.</p>
<p>By default, both functions also assign a logical vector named
<code>freevector</code>, indicating the total number of parameters and
which parameters are freely-varying (have <code>TRUE</code> values),
as an attribute of the output.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>simulateWithPriors</code> functions are effectively the
engine that powers the  <code><a href='doRun.html'>doRun</a></code> functions, while the
<code><a href='doSimulation.html'>doSimulation</a></code> function is the pistons within the
<code>simulateWithPriors</code> engine. In general, most users
will just drive the car - they will just use <code><a href='doRun.html'>doRun</a></code>,
but some users may want to use <code>simulateWithPriors</code>
or <code><a href='doSimulation.html'>doSimulation</a></code> to do various simulations.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Brian O'Meara and Barb Banbury</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>tree</span> <span class='op'>&lt;-</span> <span class='fu'>rcoal</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span>
<span class='co'># get realistic edge lengths</span>
<span class='va'>tree</span><span class='op'>$</span><span class='va'>edge.length</span> <span class='op'>&lt;-</span> <span class='va'>tree</span><span class='op'>$</span><span class='va'>edge.length</span><span class='op'>*</span><span class='fl'>20</span>

<span class='co'># example simulation</span>

<span class='co'># NOTE: the example analyses involve too few simulations,</span>
    <span class='co'># as well as overly coarse time-units...</span>
    <span class='co'># ...all for the sake of examples that reasonably test the functions</span>
    
<span class='va'>simData</span> <span class='op'>&lt;-</span> <span class='fu'>simulateWithPriors</span><span class='op'>(</span>
  phy <span class='op'>=</span> <span class='va'>tree</span>, 
  intrinsicFn <span class='op'>=</span> <span class='va'>brownianIntrinsic</span>, 
  extrinsicFn <span class='op'>=</span> <span class='va'>nullExtrinsic</span>, 
  startingPriorsFns <span class='op'>=</span> <span class='st'>"normal"</span>, 
  startingPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>simCharExample</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>simCharExample</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, 
  intrinsicPriorsFns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"exponential"</span><span class='op'>)</span>, 
  intrinsicPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, 
  extrinsicPriorsFns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fixed"</span><span class='op'>)</span>, 
  extrinsicPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
  generation.time <span class='op'>=</span> <span class='fl'>100000</span>, 
  freevector <span class='op'>=</span> <span class='cn'>NULL</span>,     
  giveUpAttempts <span class='op'>=</span> <span class='fl'>10</span>, 
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: You have only 22 timeSteps on the shortest branch in this dataset</span>
#&gt; <span class='warning'>  but should probably have a lot more if you expect change on this branch.</span>
#&gt; <span class='warning'>Please consider decreasing timeStep to no more than 0.0016</span></div><div class='input'>
<span class='va'>simData</span>
</div><div class='output co'>#&gt;                                                                       
#&gt;  9.547836e+00  4.150295e-02 -3.026773e+01  3.418391e-01  6.453546e+01 
#&gt;                                                                       
#&gt; -3.007117e+01  2.896568e-01  9.956452e-01  6.614234e+01 -3.025080e+01 
#&gt;                                                                       
#&gt;  3.796814e-01  8.707084e-01  6.650160e+01 -3.026773e+01  3.418391e-01 
#&gt;                                                                       
#&gt;  3.495804e-09  6.653546e+01 -5.479906e+01  1.135981e+02  7.823403e+00 
#&gt;                                                                       
#&gt;  1.195810e+01  2.669213e+00  1.478069e+01  9.932491e+00  1.044875e+01 
#&gt;                                                                       
#&gt;  6.941505e+00  9.646293e+00 -1.111716e+00  1.072039e+00 -1.189547e+00 
#&gt;                                                                       
#&gt;  2.626172e+00 -1.905434e-01  3.010480e-01  5.862058e-01 -9.090808e-01 
#&gt;                                                                       
#&gt; -2.857882e-01 -5.936686e-01  6.647034e-01 -3.803557e-01  7.586470e-01 
#&gt;                                                                    21 
#&gt;  2.214307e-02  1.729511e-01  3.274339e-01 -1.839619e-01  7.169150e+00 
#&gt;            22            23            24            25            26 
#&gt;  7.921066e+00  9.175249e+00  1.008808e+01  1.014071e+01  4.844487e+00 
#&gt;            27            28            29            30            31 
#&gt;  1.101510e+01  1.110375e+01  1.133103e+01  1.105411e+01  3.257514e+00 
#&gt;            32            33            34            35            36 
#&gt;  4.304719e+00  1.121909e+01  1.134805e+01  3.211705e+00  2.967029e+00 
#&gt;            37            38            39                             
#&gt;  4.518816e+00  1.167323e+01  2.956022e+00  3.676780e+00  5.100799e+00 
#&gt;                                                                       
#&gt;  6.668273e+00  8.045717e+00  8.152504e+00  2.706270e+00  9.786392e+00 
#&gt;                                                                       
#&gt;  9.971090e+00  1.020349e+01  1.016135e+01  2.291315e+00  3.393225e+00 
#&gt;                                                                       
#&gt;  1.039898e+01  1.066429e+01  2.748921e+00  2.572227e+00  4.124383e+00 
#&gt;                                                                       
#&gt;  1.130102e+01  2.732176e+00  1.066152e+01  1.074133e+01  1.168223e+01 
#&gt;                                                                       
#&gt;  1.213044e+01  1.212892e+01  6.982704e+00  1.224380e+01  1.223641e+01 
#&gt;                                                                       
#&gt;  1.245856e+01  1.194688e+01  4.223714e+00  5.216214e+00  1.203919e+01 
#&gt;                                                                       
#&gt;  1.203180e+01  3.674488e+00  3.361830e+00  4.913249e+00  1.204545e+01 
#&gt;               
#&gt;  3.179869e+00 
#&gt; attr(,"freevector")
#&gt;  starting_1 intrinsic_1 extrinsic_1 
#&gt;        TRUE        TRUE       FALSE </div><div class='input'>
<span class='va'>simDataParallel</span> <span class='op'>&lt;-</span> <span class='fu'>parallelSimulateWithPriors</span><span class='op'>(</span>
  nrepSim <span class='op'>=</span> <span class='fl'>2</span>, 
  multicore <span class='op'>=</span> <span class='cn'>FALSE</span>, 
  coreLimit <span class='op'>=</span> <span class='fl'>1</span>, 
  phy <span class='op'>=</span> <span class='va'>tree</span>, 
  intrinsicFn <span class='op'>=</span> <span class='va'>brownianIntrinsic</span>, 
  extrinsicFn <span class='op'>=</span> <span class='va'>nullExtrinsic</span>, 
  startingPriorsFns <span class='op'>=</span> <span class='st'>"normal"</span>, 
  startingPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
     <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>simCharExample</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>simCharExample</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, 
  intrinsicPriorsFns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"exponential"</span><span class='op'>)</span>, 
  intrinsicPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, 
  extrinsicPriorsFns <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fixed"</span><span class='op'>)</span>, 
  extrinsicPriorsValues <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
  generation.time <span class='op'>=</span> <span class='fl'>100000</span>, 
  checkpointFile <span class='op'>=</span> <span class='cn'>NULL</span>, checkpointFreq <span class='op'>=</span> <span class='fl'>24</span>, 
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, 
  freevector <span class='op'>=</span> <span class='cn'>NULL</span>, 
  taxonDF <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>You have only 22 timeSteps on the shortest branch in this dataset</span>
#&gt; <span class='message'>  but should probably have a lot more if you expect change on this branch.</span>
#&gt; <span class='message'>Please consider decreasing timeStep to no more than 0.0016</span></div><div class='output co'>#&gt; <span class='message'>Using 1 core(s) for simulations </span>
#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>Doing simulations: </span></div><div class='input'>
<span class='va'>simDataParallel</span>
</div><div class='output co'>#&gt;                                                                           
#&gt; result.1 9.760018 0.1797100 -62.91207 8.944325 129.8241 -62.72453 8.140874
#&gt; result.2 9.776337 0.1051511 -50.13737 2.493156 104.2747 -49.92761 1.981982
#&gt;                                                                             
#&gt; result.1 0.9980298 131.4491 -62.42822 15.478625 0.4733353 130.8564 -62.91208
#&gt; result.2 0.9930656 105.8552 -49.06543  1.041436 3.0000000 104.1309 -49.08950
#&gt;                                                                              
#&gt; result.1 8.944334 8.679890e-08 131.8242 -90.37916 184.7583 13.153407 41.13777
#&gt; result.2 3.266063 5.293501e-02 104.1790 -65.31075 134.6215  5.806912 15.95728
#&gt;                                                                      
#&gt; result.1 -22.723057 518.70321 21.948674 29.757689  66.42861 17.294459
#&gt; result.2  -5.891123  42.28749  6.666774 -3.573864 -12.43237 -0.939118
#&gt;                                                                        
#&gt; result.1 -0.5215153  -6.132746 13.6332359 11.380489  9.553875 0.5278427
#&gt; result.2 -6.6938329 -11.011112  0.1808191 -2.571592 -0.376079 4.8719921
#&gt;                                                                       
#&gt; result.1 -7.462962 -1.730839 -0.5490294 -0.8407188 -2.528203 -2.985570
#&gt; result.2  2.220494 -1.163257 -3.7126726 -2.4657865 -2.244137 -0.398084
#&gt;                                                                     21
#&gt; result.1 0.3445505 1.6355256  1.247292  0.5431617 -1.5219928 10.671592
#&gt; result.2 0.6449047 0.6889875 -1.152041 -1.3327654 -0.2805405  7.570582
#&gt;                 22        23        24       25       26        27        28
#&gt; result.1 17.867251 22.642802 26.772601 28.24163 -11.5749 26.394983 24.810413
#&gt; result.2  6.223887  5.551458  3.777487  4.67578  11.7341 -1.740221 -2.021125
#&gt;                 29        30        31        32        33        34        35
#&gt; result.1 29.256352 29.751801 -20.36775 17.327205 32.089605 31.060038 -21.04068
#&gt; result.2  7.528365 -2.509962  13.58509  5.281563  6.848467 -2.320778  15.27782
#&gt;                 36        37        38        39                              
#&gt; result.1 -21.53375 17.753283 33.142705 -20.86863 -7.192592  3.441013  9.819107
#&gt; result.2  12.18929  6.548439 -2.036146  12.40358 -1.860991 -1.392588 -1.218939
#&gt;                                                                                
#&gt; result.1 16.325504 18.0715372 -22.51232 20.109913 19.016627 23.488786 25.185115
#&gt; result.2 -1.738161 -0.6936222   5.95958 -5.058486 -5.080012  4.483322 -4.920989
#&gt;                                                                              
#&gt; result.1 -25.31006 12.66472 27.894605 27.562491 -23.40791 -23.55324 15.735680
#&gt; result.2  10.97575  2.81996  4.633675 -4.167342  14.02801  11.12307  5.483225
#&gt;                                                                           
#&gt; result.1 31.238741 -22.01365 28.53578 32.29349 35.46650 37.219697 38.41173
#&gt; result.2 -3.041363  11.79905 17.00215 13.84036 12.32186  9.293135 10.04518
#&gt;                                                                                
#&gt; result.1 -0.6374868 32.680053 30.604200 35.02392 34.3184871 -15.42544 21.989686
#&gt; result.2 17.5086139  1.578044  1.037761 10.57341 -0.0989346  16.19443  7.743166
#&gt;                                                                               
#&gt; result.1 36.284605 34.5575849 -18.67344 -19.51426 19.770886 35.04667 -19.72361
#&gt; result.2  9.063259 -0.4742136  16.52762  13.25550  7.613652 -1.03093  13.00810
#&gt; attr(,"freevector")
#&gt;  starting_1 intrinsic_1 extrinsic_1 
#&gt;        TRUE        TRUE       FALSE </div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian O'Meara, David Bapst, Barb Banbury.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


